language: python

python:
  - "2.7"

env:
  global:
    - ARTIFACTS_AWS_REGION=us-east-1
    - ARTIFACTS_S3_BUCKET=pebb

env:
  - DB=sqlite DJANGO_VERSION=1.5.5 

# command to install dependencies
install:
  - pip install -r requirements.txt --use-mirrors

before_script:
# - psql -c 'create database mysitedb;' -U postgres
  - gem install travis-artifacts
  - "export DISPLAY=:99.0"
  - "sh -e /etc/init.d/xvfb start"
  - python manage.py runserver &
  
# command to run tests
script: python manage.py test polls --liveserver=localhost:8081

#after_script:
#  - travis-artifacts upload --path hello.txt --target-path .

after_success:
#  - travis-artifacts upload --path *.png --target-path test
  - travis-artifacts upload --path vote-result.png
  - echo https://s3.amazonaws.com/pebb/artifacts/${TRAVIS_BUILD_NUMBER}/${TRAVIS_JOB_NUMBER}
